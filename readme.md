Code is available as a gist at https://gist.github.com/lgondara/18387c5f4d745673e9ca8e23f3d7ebd3
